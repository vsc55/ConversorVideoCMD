# CHANGELOG

## VERSION 2.3 - XX/12/2019
### UPDATE
  - LIMPIAR Y REORGANIZAR CODIGO.
  - MOVER `*.VBS` AL DIRECTORIO `\SRC`.
  - MOVER CHANGELOG FUERA DEL SCRIPT A `CHANGELOG.MD`
  - SEPARAR EL PROCESADO DEL AUDIO DEL CMD PRINCIPAL A `AUDIO_PRO.CMD` Y SEGMENTAR EL CODIGO.

### FIX
  - FUNCION `GetWidthByResolution` NO PROCESA BIEN LOS DATOS, NO RETORNA NUNCA NADA, SOLUCIONADO.
  - SOLUCIONAR PROBLEMA POR EL QUE SI PASAMOS A UNA FUNCION UN STRING CON EL SIMBOLO `!` SE PIERDE DICHO SIMBOLO.
    > ## EJEMPLO
    > PASAMOS > "ERROR: Algo ^(x68^)^^^^^^^!"<br/>
    > RECIVIMOS > "ERROR: Algo ^(x68^)^^"<br/>
    > SOLUCION OBTENIDA DE > https://superuser.com/questions/1292476/call-subroutine-where-parameter-contains-ampersand-in-batch-file

---

## VERSION 2.2 - 02/12/2019
### NEW
  - CREAR FUNCION `CHECK_DIR_AND_CREATE` COMPROBAR SI EXISTEN LOS DIRECTORIO Y CREARLOS SI NO EXISTEN.
  - CREAR FUNCION `CHECK_FILE_AND_FIX` PARA ELIMINAR CODIGO DUPLICADO.

### UPDATE
  - IMPLEMENTAR `CHECK_DIR_AND_CREATE` Y `CHECK_FILE_AND_FIX` PARA LIMPIAR CODIGO.

---

## VERSION 2.1 - 01/12/2019
### NEW
  - CREAR FUNCION PARA DESCARGAR ARCHIVOS DE INTERNET.
  - AL ARRANCAR COMPRUEBA SI EXISTEN LOS EJECUTABLES NECESARIOS Y SI ALGUNO NO EXISTE LO DESCARGA DE INTERNET.

---

## VERSION 2.0 - 28/11/2019
### NEW
  - AÑADIR MENU CON PERFILES PREDEFINIDOS DE LOS AJUSTES DE CODIFICACION, SE CREA UNA NUEVA VARIABLE `all_profile` DONDE SE ESPECIFICA QUE PERFIL SE HA CARGADO.
  - CREAR NUEVA VARIABLE all_a_hz PARA LA RECODIFICACION DEL ADUIO.

### UPDATE
  - SEGMENTAR EL CODIGO EN DISTINTOS ARCHIVOS PARA UN MEJOR MANTENIMIENTO.

---

## VERSION 1.9 - 18/04/2019
### NEW
  - AÑADIR A LA CODIFICAION DE VIDEO EL PARAMETOR DE `fps`.
  - AÑADIR INFORMACION DE DURACION DE VIDEO AL INICIAR EL PROCESO.
  - AÑADIR A `libx265` LA OPCION DE PROFILE Y LEVEL.
  - AÑADIR A LA FUNCION RUN_EXE LA OPOCION DE CAPTURAR STDOUT, STDERR O LAS DOS.
  - AÑADIR FUNCION FUN_FILE_DELETE_FILE PARA BORRAR ARCHIVOS.
  - AÑADIR MENSAJE PARA PODER ELIMINAR LA PISTA DE AUDIO O VIDEO QUE YA ESTA CODIFICADA Y PODER RECODIFICARLA OTRA VEZ.
  - AÑADIR MENSAJE PARA PODER DECIR SI EL VIDEO DE DE ANIMACION O NO PARA ESPECIFICAR ESE TUNE.

### UPDATE
  - MODIFICAR `libx265` PARA QUE EN VEZ DE USAR UN CFR FIJADO EN EL cmd USE EL QMIN QUE SE CONFIGURA EL INICIO DEL PROCESO.
  - MODIFICACIONES MENOS DE ALGUNOS TEXTOS INFORMATIVOS.
  - MODIFICAR EN `VideoSizeReal_Crop_ClearLog` PARA QUE RETORNE LA LISTA DE RESOLUCIONES DETECTADAS Y EL NUMERO DE VECES QUE SE HA DETECTADO CADA UNA. AHORA EL LISTADO DE RESOLUCIONES TAMBIEN SALE EL NUMERO DE VECES QUE SE HA DETECTADO ELIMINADO LAS QUE NO SE REPITEN MAS DE 5 VECES.
  - REDISEÑAR LA OBTENCION DE DATOS DE QMIN Y QMAX.
  - ACTUALIZAR ALGUNOS TEXTOS DE MENSAJES.

### FIX
  - BUG CODEC AAC, SI USAMOS EL CODEC ACC PARA CREAR ELSILENCIO Y UNIRLO A LA PISTA DE AUDIO ESTE AÑADE UNOS SEGUNDOS ENTRE LAS DOS PISTAS (SILENCIO + AUDIO) HACIENDO QUE SE EL. VIDEO Y EL AUDIO SE DESINCRONICE, SE USA UN ARTICHIO TEMPORAL WAv PARA AÑADIR EL SILENCIO Y ESE ARCHIVO ES EL QUE LUEGO SE RECODIFICA, CUANO SE SOLUCIONE EL BUG SE ELIMINARA ESE PROCESO TEMPORAL.
    > https://trac.ffmpeg.org/ticket/7846
  - CORREGUIR EN LA FUNCION FUN_CLEAR_TRIM_COMILLAS PARA QUE BORRE TODAS LAS COMILLAS AL COMIENZO Y AL FINAL CUANDO HAY MAS DE UNA.
  - CORREGUIR EN RUN_EXE EL REENVIO DE STDOUT Y STDERR CON EL COMANDO START.

### DEL
  - ELIMINAR EL PARAMETOR `-dn` DE LAS EJECUCIONES DE FFMPEG.

---

## VERSION 1.8 - 16/04/2019
### NEW
  - SEPARAR LA CODIFICACION DEL VIDEO Y LA CREACION DEL ARCHIVO FINAL EN DOS PROCESOS DISTINTOS `ProcessVideoFix` SIGUE ENCARGANDOSE DE PREPARAR LA PISTA DE VIDEO Y `ProcessMultiplexFiles` SE ENCARGA DE UNIR LA PISTA DE VIDEO+AUDIO+SUB.

### FIX
  - AÑADIR `^` A LOS SIMBOLOS ESPECIALES COMO LAS ADMIRACIONES `!`.
  - SOLUCIONAR PROBLEMA EN LA PISTA DE AUDIO YA QUE ADEMAS DEL AUDIO COPIABA TAMBIEN LOS CAPITULOS DEL MKV, AHORA YA SOLO SE COPIA LA PISTA DE AUDIO.

---

## VERSION 1.7 - 06/04/2019
### NEW
  - AÑADIR EN LA SECCION SELECT_ENCODE LA DETECCION SI ES H264 O H265 PARA PODER MODIFICAR LOS PARAMETROS DE CONFIGURACION SEGUN EL CODEC.
  - CREAR UN ARCHIVO DE DE PROCESADO NUEVO `_info_stream.txt` DONDE SE GUARDARAN TODAS LAS STREAMS QUE TIENGA EL ARCHIVO.
  - CREAR UNA NUEVA FUNCION FUN_CLEAR_TRIM_COMILLAS PARA ELIMINAR LAS COMILLAS A LA DRECHA HE IZQUIERDA, POR EJEMPLO EJEMPLO EN UN ARCHIVO "OUT.MKV" SE QUEDARIA OUT.MKV.

### UPDATE
  - ACTUALICAR ETIQUETAS DE POSICION EN LA SECCION SELECT.
  - ACTUALICAR LOS ECHO CON LA SECCION EN LA QUE SE ESTA EJECUTANDO [GLOBAL], [AUDIO], [VIDEO].
  - AHORA LAS STREAM DE CADA TIPO SE OBTIENE DE `_info_stream.txt` EN VEZ DE  `_info_ffmpeg.txt`.
  - IMPLEMENTAR RUN_EXE EN UNOS CUANTOS PROCESOS DE LA SECCION VIDEO.

### FIX
  - APLICAR ESTANDAR PARAMETROS INTERNOS.
  - ELIMINAR TODOS LOS `()` DE LOS ECHO Y CAMBIARLOS POR `[]` PARA EVITAR ERRORES.
  - MODIFICAR TANTO EN AUDIO COMO EN VIDIO UNOS IF AL COMIENZO QUE TE HACIAN UN EXIT SUB SIN EJECUTAR ENDLOCAL, AHORA ESOS IF SE EJECUTAN ANTES DE SETLOCAL.

---

## VERSION 1.6 - 04/04/2019
### NEW
  - CREAR AUDIOGETMAXVOL.VBS PARA COMPROBAR SI EL VOLUMEN ES CORRECTO O HAY QUE CORREGIRLO.
  - AÑADIR FUNCION DEBUG EN LOS ARCHIVOS `*.VBS`.
  - AÑADIR SOPORTE PARA LA CORRECCION DEL VOLUMEN DE LOS ARCHIVOS CON AACGAIN. PARA CAMBIAR ENTRE FFMPGE Y AACGAIN HAY QUE MODIFICAR LA VARIABLE `default_a_process`, DEFINIENDOLA COMO `set default_a_process=ACCGAIN` PARA ACCGAIN Y `set default_a_process=FFMPGE` PARA FFMPEG.
  - AÑADIR CONFIGURACION DEFAUL `default_a_hz` PARA LOS HZ EN LA RECODIFICACION DEL AUDIO.
  - AÑADIR LA DETECCION DE SI EL ARCHIVO TIENE PISTAS DE VIDEO, AUDIO O SUBTITULOS.

### UPDATE
  - ACTUALIZAR `AUDIOGETINITTIME.VBS` PARA QUE SE ENCARGE DE LEER EL LOG DE FFMPG Y OBTENER LOS SEGUNDOS DE DESFASE ENTRE AUDIO Y VIDEO.
  - UNIR LA RECODIFICACION DEL AUDIO Y EL AJUSTE DEL VOLUMEN EN EL MISMO PROCESO.
  - ELIMINAR LA DETECCION DE LA PISTA DE AUDIO DEL CMD, AHORA LA OBTIENE `AUDIOGETID.VBS`.
  - AÑADIR A LA FUNCION `RUN_EXE` LA OPCION DE QUE DATOS DESEAMOS CAPTURAR. SI QUEREMOS USAR `RUN > FILE` O `RUN 2> FILE`. 
POR DEFECTO SI NO SE PASA NADA SE USAR `2>` PARA USAR `>` TENDREMOS QUE PASARLE EL PAREMETRO `1` DE ESTA FORMA `RUN_EXE !FileOut! 1`.

### FIX
  - SOLUCIONAR ERROR QUE SE PRODUCIA SI EL ARCHIVO NO TENIA SUBTITULOS.

### DEL
  - ELIMINAR COMENTARIO NO NECESARIOS.

---

## VERSION 1.5 - 01/04/2019
### NEW
  - CREAR NUEVA FUNCION RUN_EXE PARA EJECUTAR PROGRAMA EXTERNOS Y CONTRLAR EL DEBUG.
  - AÑADIR RECODIFICACION Y CONTROL DEL VOLUMEN EN LA PISTA DE AUDIO.
  - AÑADIR MENU PARA PODER DEFINIR EL NUEVO BITRATE PARA LA PISTA DE AUDIO.
  - AÑADIR NUEVA OPCION DE ENCODE DE VIDEO LLAMADA COPY, DE ESTE MODO LA PISTA DE VIDEO SOLO SE COPIARA NO SE EFECTUARA NINGUNA MODIFICACION. ESTO PUEDE USARSE SI SOLO SE QUIERE RECODIFICAR LA PISTA DE AUDIO.

### UPDATE
  - ETIQUETAR PROCESOS DE VIDEO Y AUDIO.
  - IMPLEMENTAR NUEVA FUNCION `RUN_EXE` EN TODAS LAS EJECUCIONES EXTERNAS.
  - ELIMINAR DEBUGMODE `yesSTOP` Y CREAR 2 NUEVOS PARA `STOP AUDIO` Y `STOP VIDEO`.

### FIX
  - SOLUCIONAR PROBLEMA QUE PRODUCIA QUE NO SE COPIASEN LOS SUBTITULOS.

### DEL
  - ELIMINAR CODIGO OBSOLETO O NO NECESARIO.

---

## VERSION 1.4 - 31/03/2019
### NEW
  - AÑADIR PARAMETROS DE CONFIGURACION DE VALORES POR DEFECTO.
  - ACTUALIZAR SISTEMA DE DETECCION DE BORDES NUEVOS, AHORA SE ELIMINAN LAS RESOLUCIONES DUPLICADAS Y DEFINIMOS EL SEGUDO DONDE DESEAMOS INICIAR EL MUESTRESO Y LA DURACION DE DICHO MUESTREO.
  - AÑADOR SOPORTE PARA QMIN Y QMAX (DINAMICO) O UNA Q ESTATICA TANTO EN X264 COM X265.
  - AÑADIR -pix_fmt.
  - AÑADIR CONFIGURACIONES GLOBALES COMO SI DESEASMOS OMITIR LA DETECCION DE BORDE A TODOS LOS ARCHIVOS, O EL CAMBIO DE TAMAÑO.

### UPDATE
  - MOVER LOS CUADROS DE CONFIGURACION (CAMBIO TAMAÑO, PERFIL, ETC) A SUB FUNCIONES.
  - AHORA DEFINIMOS SI ESTAMOS EN MODO DEBUG CREANDO UN ARCHIVO EN EL DIRECTORIO DONDE ESTA EL SCRIPT `debug_on`.

---

## VERSION 1.3 - 03/02/2019
### NEW:
  - AÑADIR SOPORTE H265 - GPU.
  - AÑADIR SOPORTE H264 Y H265 - CPU.
  - AÑADIR SOPORTE PARA CAMBIAR DE TAMAÑO EL VIDEO.
  - AÑADIR OPCION DE SOLO RECODIFICAR SIN DETECTAR BORDE.
  - AÑADIR SECCION PARA RECODIFICAR AUDIO, AUNQUE NO HACE NADA AUN.
  - CREAR FUNCION `GetWidthByResolution` PARA OBTENER LA ANCHURA DESDE UNA RESOLUCION.

### UPDATE
  - LA VAR `!RunFunction!` SE HA ELIMINADO DE CADA ENCODER Y SE EJECUTA AL FINAL.
  - CADA ENCODER AJUSTAR LAS NUEVAS VAR `!video_f!`, `!video_e!`, `!audio_f!`, `!audio_e!`, QUE SE USARAN LUEGO AL EJECUTAR FFMPEG.

### DEL
  - ELIMINAR CODIGO QUE USA BITRATE MANUAL.

---

## VERSION 1.2 - 03/02/2019
### NEW
  - AÑADIR OPCION DEBUG PARA MOSTRAR MAS INFO `no/yes/yesSTOP`.
  - AÑADIR SOPORTE PARA ENCODING POR CPU `libx264`.
  - SI NO SE OBTIENE EL BITRATE CON `ffprobe` SE LLAMA A `MediaInfo` PARA OBTENER INFO DEL BITRATE.

### UPDATE
  - REORGANIZAR CODIGO.

### FIX
  - ELIMINAR LAS DOS PASADAS CON CODIFICADOR NVIDIA YA QUE NO LO SOPORTA, AÑADIR SOPORTE.

---

## VERSION 1.1 - 28/01/2019
### NEW
  - AÑADIR OPACION PARA PODER EFECTUAR UN NUEVO MUESTRESO DE BORDES CON PARAMETROS DISTINTOS.

---

## VERSION 1.0 - 19/01/2019
### NEW
  - CREAR SCRIPT, SOPORTE UNICAMENTE A GPU `h264_nvenc`.
